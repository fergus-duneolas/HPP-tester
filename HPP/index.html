<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>HPP Return Catcher</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script>
    // If we’re inside an iframe, try to pop to the top window
    (function ensureTopNav() {
      try { if (window.top !== window.self) window.top.location.href = window.location.href; } catch {}
    })();

    // OPTIONAL: immediately bounce to your backend with the same query string
    // e.g. const AUTO_REDIRECT_TO = "https://your.app/payments/return";
    const AUTO_REDIRECT_TO = ""; // set to your backend URL to auto-redirect
    (function maybeBounce() {
      if (AUTO_REDIRECT_TO) {
        const sep = AUTO_REDIRECT_TO.includes("?") ? "&" : "?";
        window.location.replace(AUTO_REDIRECT_TO + sep + window.location.search.slice(1));
      }
    })();
  </script>
  <style>
    body { font-family: system-ui, sans-serif; margin: 2rem; line-height: 1.4; }
    code, pre { background: #f4f4f4; padding: .5rem; border-radius: .5rem; }
    .kv { display: grid; grid-template-columns: 220px 1fr; gap: .5rem 1rem; }
    .kv div { padding: .25rem 0; }
    .ok { color: #0a7a25; } .warn { color: #b35a00; }
  </style>
</head>
<body>
  <h1>HPP Return Catcher</h1>
  <p class="ok">You’ve been redirected back from Global Payments HPP.</p>

  <h2>Full URL</h2>
  <pre id="full"></pre>

  <h2>Query Parameters</h2>
  <div class="kv" id="params"></div>

  <script>
    document.getElementById('full').textContent = window.location.href;
    const qp = new URLSearchParams(window.location.search);
    const out = document.getElementById('params');
    if ([...qp.keys()].length === 0) out.innerHTML = '<div class="warn">No query parameters present.</div>';
    else {
      const frag = document.createDocumentFragment();
      qp.forEach((v, k) => {
        const kEl = document.createElement('div'); kEl.innerHTML = `<code>${k}</code>`;
        const vEl = document.createElement('div'); vEl.textContent = v;
        frag.appendChild(kEl); frag.appendChild(vEl);
      });
      out.appendChild(frag);
    }
  </script>
</body>
</html>
